var noname={version:"0.1",Charts:{}};noname.Charts.createPieChart=function(a){a=new noname.PiePlot(a);return new noname.Chart(a)};noname.Charts.createBarChart=function(a,b,c){a=new noname.CategoryPlot(a);a.xAxis.label=b;a.yAxis.label=c;a.renderer=new noname.BarRenderer;return new noname.Chart(a)};noname.Charts.createStackedBarChart=function(a,b,c){a=new noname.CategoryPlot(a);a.xAxis.label=b;a.yAxis.label=c;a.renderer=new noname.StackedBarRenderer;return new noname.Chart(a)};
noname.Charts.createStackedAreaChart=function(a,b,c){a=new noname.CategoryPlot(a);a.xAxis.label=b;a.yAxis.label=c;a.renderer=new noname.StackedAreaRenderer;return new noname.Chart(a)};noname.Charts.createLineChart=function(a,b,c){a=new noname.CategoryPlot(a);a.xAxis.label=b;a.yAxis.label=c;a.renderer=new noname.LineRenderer;return new noname.Chart(a)};noname.Charts.createScatterChart=function(a,b,c){a=new noname.XYPlot(a);a.xAxis.label=b;a.yAxis.label=c;return new noname.Chart(a)};
noname.Charts.createXYLineChart=function(a,b,c){a=new noname.XYPlot(a);a.xAxis.label=b;a.yAxis.label=c;b=new noname.XYLineRenderer;c=new noname.Chart(a);a.setRenderer(b);return c};noname.Charts.createHistogram=function(a,b,c){a=new noname.XYPlot(a);a.xAxis.label=b;a.yAxis.label=c;b=new noname.HistogramRenderer;c=new noname.Chart(a);a.setRenderer(b);return c};noname.LinearAxis=function(a){if(!(this instanceof noname.LinearAxis))return new noname.LinearAxis;this.label=a;this.autoRange=!0;this.autoRangeIncludeZero=!1;this.upperMargin=this.lowerMargin=0.05;this.listeners=[];this.nice=!0;this.scaleD3=d3.scale.linear()};noname.LinearAxis.prototype.updateDomain=function(a,b){var c=b-a,d;0<c?(d=this.lowerMargin*c,c*=this.upperMargin):c=d=0.5;this.scaleD3.domain([a-d,b+c]);this.nice&&this.scaleD3.nice()};noname.LinearAxis.prototype.addListener=function(a){this.listeners.push(a)};noname.OrdinalAxis=function(a){if(!(this instanceof noname.OrdinalAxis))return new noname.OrdinalAxis;this.label=a;this.upperMargin=this.lowerMargin=0.05;this.listeners=[];this.scaleD3=d3.scale.ordinal()};noname.OrdinalAxis.prototype.addListener=function(a){this.listeners.push(a)};noname.DatasetUtils={};noname.DatasetUtils.extractStackBaseValues=function(a,b){b="undefined"!==typeof b?b:0;for(var c=new noname.KeyedValues2DDataset,d=a.columnCount(),e=a.rowCount(),g=0;g<d;g++)for(var f=a.columnKey(g),h=b,k=b,l=0;l<e;l++){var m=a.valueByIndex(l,g),n=a.rowKey(l);0<l?0<=m?c.add(n,f,h):c.add(n,f,k):c.add(n,f,b);0<m&&(h+=m);0>m&&(k+=m)}return c};
noname.DatasetUtils.extractXYDatasetFromColumns=function(a,b,c){for(var d=new noname.XYDataset,e=0;e<a.seriesCount();e++)for(var g=a.seriesKey(e),f=0;f<a.rowCount();f++){var h=a.rowKey(f),k=a.valueByKey(g,h,b),h=a.valueByKey(g,h,c);d.add(g,k,h)}return d};noname.DatasetUtils.extractXYDatasetFromRows=function(a,b,c){for(var d=new noname.XYDataset,e=0;e<a.seriesCount();e++)for(var g=a.seriesKey(e),f=0;f<a.columnCount();f++){var h=a.columnKey(f),k=a.valueByKey(g,b,h),h=a.valueByKey(g,c,h);d.add(g,k,h)}return d};noname.KeyedValuesDataset=function(){if(!(this instanceof noname.KeyedValuesDataset))return new noname.KeyedValuesDataset;this.data=[];this.listeners=[]};noname.KeyedValuesDataset.prototype.itemCount=function(){return this.data.length};noname.KeyedValuesDataset.prototype.isEmpty=function(){return 0===this.data.length};noname.KeyedValuesDataset.prototype.key=function(a){return this.data[a][0]};noname.KeyedValuesDataset.prototype.keys=function(){return this.data.map(function(a){return a[0]})};
noname.KeyedValuesDataset.prototype.indexOf=function(a){for(var b=this.data.length,c=0;c<b;c++)if(this.data[c][0]===a)return c;return-1};noname.KeyedValuesDataset.prototype.valueByIndex=function(a){return this.data[a][1]};noname.KeyedValuesDataset.prototype.valueByKey=function(a){a=this.indexOf(a);return 0>a?null:this.valueByIndex(a)};noname.KeyedValuesDataset.prototype.addListener=function(a){this.listeners.push(a)};
noname.KeyedValuesDataset.prototype.removeListener=function(a){a=this.listeners.indexOf(a);0<=a&&this.listeners.splice(a,1)};noname.KeyedValuesDataset.prototype.notifyListeners=function(){for(var a=0;a<this.listeners.length;a++)this.listeners[a].datasetChanged(this)};noname.KeyedValuesDataset.prototype.add=function(a,b){var c=this.indexOf(a);0>c?this.data.push([a,b]):this.data[c][1]=b;this.notifyListeners()};
noname.KeyedValuesDataset.prototype.remove=function(a){if(!a)throw Error("The 'sectionKey' must be defined.");var b=this.indexOf(a);if(0>b)throw Error("The sectionKey '"+a.toString()+"' is not recognised.");this.data.splice(b,1);this.notifyListeners()};noname.KeyedValuesDataset.prototype.parse=function(a){this.data=JSON.parse(a);this.notifyListeners()};noname.KeyedValuesDataset.prototype.load=function(a){this.data=a;this.notifyListeners()};
noname.KeyedValuesDataset.prototype.removeByIndex=function(a){this.data.splice(a,1)};noname.KeyedValuesDataset.prototype.totalForDataset=function(a){for(var b=0,c=a.itemCount(),d=0;d<c;d++){var e=a.valueByIndex(d);e&&(b+=e)}return b};noname.KeyedValuesDataset.prototype.minForDataset=function(a){for(var b=null,c=a.itemCount(),d=0;d<c;d++){var e=a.valueByIndex(d);e&&(b=b?Math.min(b,e):e)}return b};
noname.KeyedValuesDataset.prototype.maxForDataset=function(a){for(var b=null,c=a.itemCount(),d=0;d<c;d++){var e=a.valueByIndex(d);e&&(b=b?Math.max(b,e):e)}return b};noname.KeyedValuesDataset.prototype.total=function(){return this.totalForDataset(this)};noname.KeyedValuesDataset.prototype.min=function(){return this.minForDataset(this)};noname.KeyedValuesDataset.prototype.max=function(){return this.maxForDataset(this)};noname||(noname={});noname.KeyedValues2DDataset=function(){if(!(this instanceof noname.KeyedValues2DDataset))return new noname.KeyedValues2DDataset;this.data={columnKeys:[],rows:[]};this.listeners=[]};noname.KeyedValues2DDataset.prototype.rowCount=function(){return this.data.rows.length};noname.KeyedValues2DDataset.prototype.columnCount=function(){return this.data.columnKeys.length};
noname.KeyedValues2DDataset.prototype.isEmpty=function(){return this.data.hasOwnProperty("columnKeys")?0===this.data.columnKeys.length&&0===this.data.rows.length:!0};noname.KeyedValues2DDataset.prototype.addListener=function(a){this.listeners.push(a)};noname.KeyedValues2DDataset.prototype.removeListener=function(a){a=this.listeners.indexOf(a);0<=a&&this.listeners.splice(a,1)};noname.KeyedValues2DDataset.prototype.notifyListeners=function(){};
noname.KeyedValues2DDataset.prototype.add=function(a,b,c){if(this.isEmpty())this.data.columnKeys.push(b),this.data.rows.push([a,[c]]);else{var d=this.columnIndex(b);if(0>d){this.data.columnKeys.push(b);d=this.data.rows.length;for(b=0;b<d;b++)this.data.rows[b][1].push(null);d=this.columnCount()-1}b=this.rowIndex(a);0>b?(b=Array(this.columnCount()),b[d]=c,this.data.rows.push([a,b])):this.data.rows[b][1][d]=c}};noname.KeyedValues2DDataset.prototype.parse=function(a){this.load(JSON.parse(a))};
noname.KeyedValues2DDataset.prototype.load=function(a){this.data=a;this.data.hasOwnProperty("rows")||(this.data.rows=[]);this.data.hasOwnProperty("columnKeys")||(this.data.columnKeys=[]);this.notifyListeners()};noname.KeyedValues2DDataset.prototype.valueByIndex=function(a,b){return this.data.rows[a][1][b]};noname.KeyedValues2DDataset.prototype.rowKey=function(a){return this.data.rows[a][0]};
noname.KeyedValues2DDataset.prototype.rowIndex=function(a){for(var b=this.data.rows.length,c=0;c<b;c++)if(this.data.rows[c][0]===a)return c;return-1};noname.KeyedValues2DDataset.prototype.rowKeys=function(){return this.data.rows.map(function(a){return a[0]})};noname.KeyedValues2DDataset.prototype.columnKey=function(a){return this.data.columnKeys[a]};
noname.KeyedValues2DDataset.prototype.columnIndex=function(a){for(var b=this.data.columnKeys.length,c=0;c<b;c++)if(this.data.columnKeys[c]===a)return c;return-1};noname.KeyedValues2DDataset.prototype.columnKeys=function(){return this.data.columnKeys.map(function(a){return a})};noname.KeyedValues2DDataset.prototype.valueByKey=function(a,b){var c=this.rowIndex(a),d=this.columnIndex(b);return this.valueByIndex(c,d)};
noname.KeyedValues2DDataset.prototype.minForDataset=function(a){for(var b=null,c=a.rowCount(),d=a.columnCount(),e=0;e<c;e++)for(var g=0;g<d;g++){var f=a.valueByIndex(e,g);f&&(b=b?Math.min(b,f):f)}return b};noname.KeyedValues2DDataset.prototype.maxForDataset=function(a){for(var b=null,c=a.rowCount(),d=a.columnCount(),e=0;e<c;e++)for(var g=0;g<d;g++){var f=a.valueByIndex(e,g);f&&(b=b?Math.max(b,f):f)}return b};noname.KeyedValues2DDataset.prototype.min=function(){return this.minForDataset(this)};
noname.KeyedValues2DDataset.prototype.max=function(){return this.maxForDataset(this)};noname.KeyedValues2DDataset.prototype.yValues=function(a){return this.data.rows[a][1].map(function(a){return a})};noname.KeyedValues2DDataset.prototype.bounds=function(){for(var a=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,c=this.rowCount(),d=this.columnCount(),e=0;e<c;e++)for(var g=0;g<d;g++){var f=this.valueByIndex(e,g);f&&(a=Math.min(a,f),b=Math.max(b,f))}return[a,b]};noname.KeyedValues3DDataset=function(){if(!(this instanceof noname.KeyedValues3DDataset))return new noname.KeyedValues3DDataset;this.data={columnKeys:[],rowKeys:[],series:[]};this.listeners=[]};noname.KeyedValues3DDataset.prototype.isEmpty=function(){return 0===this.data.columnKeys.length&&0===this.data.rowKeys.length};noname.KeyedValues3DDataset.prototype.seriesCount=function(){return this.data.series.length};noname.KeyedValues3DDataset.prototype.rowCount=function(){return this.data.rowKeys.length};
noname.KeyedValues3DDataset.prototype.columnCount=function(){return this.data.columnKeys.length};noname.KeyedValues3DDataset.prototype._fetchRow=function(a,b){for(var c=this.data.series[a].rows,d=0;d<c.length;d++)if(c[d][0]===b)return c[d];return null};noname.KeyedValues3DDataset.prototype.valueByIndex=function(a,b,c){b=this.rowKey(b);a=this._fetchRow(a,b);return null===a?null:a[1][c]};
noname.KeyedValues3DDataset.prototype.seriesIndex=function(a){for(var b=this.seriesCount(),c=0;c<b;c++)if(this.data.series[c].seriesKey===a)return c;return-1};noname.KeyedValues3DDataset.prototype.seriesKey=function(a){return this.data.series[a].seriesKey};noname.KeyedValues3DDataset.prototype.rowKey=function(a){return this.data.rowKeys[a]};noname.KeyedValues3DDataset.prototype.rowIndex=function(a){for(var b=this.data.rowKeys.length,c=0;c<b;c++)if(this.data.rowKeys[c]===a)return c;return-1};
noname.KeyedValues3DDataset.prototype.rowKeys=function(){return this.data.rowKeys.map(function(a){return a})};noname.KeyedValues3DDataset.prototype.columnKey=function(a){return this.data.columnKeys[a]};noname.KeyedValues3DDataset.prototype.columnIndex=function(a){for(var b=this.data.columnKeys.length,c=0;c<b;c++)if(this.data.columnKeys[c]===a)return c;return-1};noname.KeyedValues3DDataset.prototype.columnKeys=function(){return this.data.columnKeys.map(function(a){return a})};
noname.KeyedValues3DDataset.prototype.valueByKey=function(a,b,c){a=this.seriesIndex(a);b=this._fetchRow(a,b);if(null===b)return null;c=this.columnIndex(c);return b[1][c]};noname.KeyedValues3DDataset.prototype.addListener=function(a){this.listeners.push(a)};noname.KeyedValues3DDataset.prototype.removeListener=function(a){a=this.listeners.indexOf(a);0<=a&&this.listeners.splice(a,1)};noname.KeyedValues3DDataset.prototype.notifyListeners=function(){};
noname.KeyedValues3DDataset.prototype.add=function(a,b,c,d){if(this.isEmpty())this.data.rowKeys.push(b),this.data.columnKeys.push(c),this.data.series.push({seriesKey:a,rows:[[b,[d]]]});else{var e=this.seriesIndex(a);0>e&&(this.data.series.push({seriesKey:a,rows:[]}),e=this.data.series.length-1);a=this.columnIndex(c);if(0>a){this.data.columnKeys.push(c);for(a=0;a<this.data.series.length;a++){c=this.data.series[a].rows;for(var g=0;g<c.length;g++)c[g][1].push(null)}a=this.columnCount()-1}0>this.rowIndex(b)?
(this.data.rowKeys.push(b),c=noname.Utils.makeArrayOf(null,this.columnCount()),c[a]=d,this.data.series[e].rows.push([b,c])):(c=this._fetchRow(e,b),null!==c?c[1][a]=d:(c=noname.Utils.makeArrayOf(null,this.columnCount()),c[a]=d,this.data.series[e].rows.push([b,c])))}};noname.KeyedValues3DDataset.prototype.parse=function(a){this.load(JSON.parse(a))};
noname.KeyedValues3DDataset.prototype.load=function(a){this.data=a;this.data.hasOwnProperty("rowKeys")||(this.data.rowKeys=[]);this.data.hasOwnProperty("columnKeys")||(this.data.columnKeys=[]);this.data.hasOwnProperty("series")||(this.data.series=[]);this.notifyListeners()};noname.XYDataset=function(){this.data={series:[]};this.selections=[];this._listeners=[]};noname.XYDataset.prototype.seriesCount=function(){return this.data.series.length};noname.XYDataset.prototype.seriesKeys=function(){return this.data.series.map(function(a){return a.seriesKey})};noname.XYDataset.prototype.seriesKey=function(a){return this.data.series[a].seriesKey};
noname.XYDataset.prototype.seriesIndex=function(a){if("string"!==typeof a)throw Error("The 'seriesKey' must be a string.");for(var b=this.data.series,c=this.data.series.length,d=0;d<c;d++)if(b[d].seriesKey===a)return d;return-1};noname.XYDataset.prototype.itemCount=function(a){return this.data.series[a].items.length};noname.XYDataset.prototype.x=function(a,b){return this.data.series[a].items[b].x};noname.XYDataset.prototype.y=function(a,b){return this.data.series[a].items[b].y};
noname.XYDataset.prototype.item=function(a,b){return this.data.series[a].items[b]};noname.XYDataset.prototype.items=function(a){return this.data.series[a].items};noname.XYDataset.prototype.allItems=function(){for(var a=[],b=0;b<this.data.series.length;b++)a.push(this.items(b));return a};noname.XYDataset.prototype.addListener=function(a){this._listeners.push(a);return this};noname.XYDataset.prototype.removeListener=function(a){a=this._listeners.indexOf(a);0<=a&&this._listeners.splice(a,1);return this};
noname.XYDataset.prototype.notifyListeners=function(){for(var a=0;a<this._listeners.length;a++)this._listeners[a].datasetChanged(this);return this};noname.XYDataset.prototype.add=function(a,b,c){if("string"!==typeof a)throw Error("The 'seriesKey' must be a string.");var d=this.seriesIndex(a);0>d&&(this.addSeries(a),d=this.data.series.length-1);this.data.series[d].items.push({x:b,y:c});this.notifyListeners();return this};
noname.XYDataset.prototype.remove=function(a,b){var c=this.seriesIndex(a);this.data.series[c].items.splice(b,1);this.notifyListeners();return this};noname.XYDataset.prototype.addSeries=function(a){if("string"!==typeof a)throw Error("The 'seriesKey' must be a string.");if(0<=this.seriesIndex(a))throw Error("There is already a series with the key '"+a);this.data.series.push({seriesKey:a,items:[]});return this};
noname.XYDataset.prototype.removeSeries=function(a){if("string"!==typeof a)throw Error("The 'seriesKey' must be a string.");a=this.seriesIndex(a);0<=a&&this.data.series.splice(a,1);return this};
noname.XYDataset.prototype.bounds=function(){for(var a=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=0;e<this.seriesCount();e++)for(var g=0;g<this.itemCount(e);g++)var f=this.item(e,g),a=Math.min(a,f.x),b=Math.max(b,f.x),c=Math.min(c,f.y),d=Math.max(d,f.y);return[a,b,c,d]};
noname.XYDataset.prototype.select=function(a,b,c){var d=this._indexOfSelection(a);0>d?(a={id:a,items:[]},this.selections.push(a)):a=this.selections[d];0>noname.Utils.findInArray(a.items,function(a){return a.seriesKey===b&&a.item===c})&&a.items.push({seriesKey:b,item:c});return this};
noname.XYDataset.prototype.unselect=function(a,b,c){a=this._indexOfSelection(a);if(0<=a){a=this.selections[a];var d=noname.Utils.findInArray(a.items,function(a,d){return a.seriesKey===b&&a.item===c});0<=d&&a.items.splice(d,1)}return this};noname.XYDataset.prototype.isSelected=function(a,b,c){a=this._indexOfSelection(a);return 0>a?!1:0<=noname.Utils.findInArray(this.selections[a].items,function(a){return a.seriesKey===b&&a.item===c})};
noname.XYDataset.prototype.clearSelection=function(a){a=this._indexOfSelection(a);0<=a&&this.selections.splice(a,1);return this};noname.XYDataset.prototype._indexOfSelection=function(a){return noname.Utils.findInArray(this.selections,function(b){return b.id===a})};noname.CategoryPlot=function(a){if(!(this instanceof noname.CategoryPlot))return new noname.CategoryPlot;this.xAxis=new noname.OrdinalAxis;this.yAxis=new noname.LinearAxis;this.dataset=a;this.dataset.addListener(this.datasetChanged);this.colors=d3.scale.category10();this.colors.domain(this.dataset.rowKeys);this.listeners=[];this.rotateTickLabels=!1};noname.CategoryPlot.prototype.addListener=function(a){this.listeners.push(a)};noname.CategoryPlot.prototype.datasetChanged=function(a){};
noname.CategoryPlot.prototype.build=function(a,b){var c=b.append("g");c.attr("transform","translate("+a.margin.left.toString()+","+a.margin.top.toString()+")");var d=a.width-a.margin.left-a.margin.right;this.xAxis.scaleD3.domain(this.dataset.data.columnKeys).rangeBands([0,d]);var e=this.renderer.bounds(this.dataset),g=e[0],f=e[1],e=a.height-a.margin.top-a.margin.bottom,h,k;k=f-g;0<k?(h=this.yAxis.lowerMargin*k,k*=this.yAxis.upperMargin):k=h=0.5;this.yAxis.scaleD3.domain([g-h,f+k]).nice().range([e,
0]);f=d3.svg.axis().scale(this.xAxis.scaleD3).tickSize(5,3,1).tickSubdivide(10).tickPadding(5).orient("bottom");g=d3.svg.axis().scale(this.yAxis.scaleD3).tickSize(5,3,1).tickPadding(5).orient("left");f=c.append("g").attr("class","x axis").attr("transform","translate(0,"+e+")").call(f);this.xAxis.rotateTickLabels&&f.selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(90)").style("text-anchor","start");c.append("g").attr("class","y axis").call(g);this.xAxis.label&&
c.append("text").attr("class","x label").attr("text-anchor","end").attr("x",d).attr("y",e-6).text(this.xAxis.label);this.yAxis.label&&c.append("text").attr("class","y label").attr("text-anchor","end").attr("y",6).attr("dy",".75em").attr("transform","rotate(-90)").text(this.yAxis.label);this.renderer.build(a,this,this.xAxis.scaleD3,this.yAxis.scaleD3,c)};noname.PiePlot=function(a){if(!(this instanceof noname.PiePlot))return new noname.PiePlot;this.dataset=a;this.dataset.addListener(this);this.colors=d3.scale.category10();this.colors.domain(this.dataset.keys);this.radius=100;this.labelAnchorRadius=1.1;this.innerRadius=0;this.toolTipHandler=null;this.listeners=[]};noname.PiePlot.prototype.addListener=function(a){this.listeners.push(a)};noname.PiePlot.prototype.datasetChanged=function(a){this.update(this.chart)};
noname.PiePlot.prototype.setDataset=function(a){this.dataset=a;this.dataset.addListener(this)};
noname.PiePlot.prototype.update=function(a){a=d3.select(a.elementId).select(".plot");var b=this.layout(this.dataset.data),c=this.colors,d=this.toolTipHandler,e=a.selectAll(".arc").data(b);e.enter().append("g").attr("class","arc").append("path").attr("d",this.arcGenerator).style("fill",function(a){return c(a.data[0])}).style("stroke","#2E2E2E");e.select("path").attr("d",this.arcGenerator).style("fill",function(a){return c(a.data[0])}).on("mouseover",function(a){null!==d&&d.mouseover(d3.event.target,
a.data[0],d3.event.target.__data__)}).on("mouseout",function(a){});e.exit().remove();a=a.selectAll(".labels").data(b);var g=this.labelAnchorRadius,f=this.radius;a.enter().append("text").attr("class","labels").text(function(a){return a.data[0]}).attr("dy",".35em");a.transition().text(function(a){return a.data[0]}).attr("transform",function(a){var b=(a.endAngle+a.startAngle)/2;a=f*Math.sin(b)*g;b=-f*Math.cos(b)*g;return"translate("+[a,b]+")"}).style("text-anchor",function(a){a=(a.endAngle+a.startAngle)/
2;return a<Math.PI/6?"middle":a<5*Math.PI/6?"start":a<7*Math.PI/6?"middle":a<11*Math.PI/6?"end":"middle"});a.exit().remove()};
noname.PiePlot.prototype.build=function(a,b){var c=b.append("g").attr("class","plot"),d=a.width-a.margin.left-a.margin.right,e=a.height-a.margin.top-a.margin.bottom,g=a.margin.left+Math.round(d/2),f=a.margin.top+Math.round(e/2);c.attr("transform","translate("+g.toString()+","+f.toString()+")");this.radius=Math.min(d,e)/2-10;this.layout=d3.layout.pie().sort(null).value(function(a){return a[1]});this.arcGenerator=d3.svg.arc().outerRadius(this.radius).innerRadius(this.innerRadius);this.update(a)};var d3;noname.XYPlot=function(a){if(!(this instanceof noname.XYPlot))return new noname.XYPlot;this.xAxis=new noname.LinearAxis;this.yAxis=new noname.LinearAxis;this.updateBounds=!1;this.renderer=new noname.ScatterRenderer;this.dataset=a;this.dataset.addListener(this);this.listeners=[]};noname.XYPlot.prototype.addListener=function(a){this.listeners.push(a)};noname.XYPlot.prototype.setDataset=function(a){this.dataset=a;this.dataset.addListener(this)};noname.XYPlot.prototype.rendererChanged=function(a){};
noname.XYPlot.prototype.setRenderer=function(a){this.renderer=a};
noname.XYPlot.prototype.update=function(a){var b=d3.select(a.elementId).select(".plot");if(this.updateBounds){var c=this.dataset.bounds(),d=c[2],e=c[3];this.xAxis.updateDomain(c[0],c[1]);this.yAxis.updateDomain(d,e);this.zoomD3.x(this.xAxis.scaleD3).y(this.yAxis.scaleD3).scale(1).translate([0,0]);this.updateBounds=!1}b.selectAll("g.x.axis").transition().call(this.xAxisD3);b.selectAll("g.y.axis").transition().call(this.yAxisD3);this.renderer.update(a,this,this.xAxis.scaleD3,this.yAxis.scaleD3,b)};
noname.XYPlot.prototype.build=function(a,b){var c=b.append("g").attr("class","plot");c.attr("transform","translate("+a.margin.left.toString()+","+a.margin.top.toString()+")");var d=this.dataset.bounds(),e=d[2],g=d[3],f=a.width-a.margin.left-a.margin.right,h=a.height-a.margin.top-a.margin.bottom;this.xAxis.updateDomain(d[0],d[1]);this.xAxis.scaleD3.range([0,f]);this.yAxis.updateDomain(e,g);this.yAxis.scaleD3.range([h,0]);this.xAxisD3=d3.svg.axis().scale(this.xAxis.scaleD3).tickSize(5,3,1).tickSubdivide(10).tickPadding(5).orient("bottom");
this.yAxisD3=d3.svg.axis().scale(this.yAxis.scaleD3).tickSize(5,3,1).tickPadding(5).orient("left");c.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(this.xAxisD3);c.append("g").attr("class","y axis").call(this.yAxisD3);this.xAxis.label&&c.append("text").attr("class","x label").attr("text-anchor","end").attr("x",f).attr("y",h-6).text(this.xAxis.label);this.yAxis.label&&c.append("text").attr("class","y label").attr("text-anchor","end").attr("y",6).attr("dy",".75em").attr("transform",
"rotate(-90)").text(this.yAxis.label);b.append("clipPath").attr("id","clip1").append("rect").attr("width",f).attr("height",h);c=c.append("g").attr("clip-path","url(#clip1)").append("g").attr("pointer-events","all");c.append("rect").attr("x",-1E3).attr("y",-1E3).attr("width",f+1E3).attr("height",h+1E3).attr("visibility","hidden");var k=this;this.zoomD3=d3.behavior.zoom().x(this.xAxis.scaleD3).y(this.yAxis.scaleD3).on("zoom",function(){k.update(k.chart)});c.call(this.zoomD3);this.renderer.build(a,this,
this.xAxis.scaleD3,this.yAxis.scaleD3,c)};noname.XYPlot.prototype.datasetChanged=function(a){this.updateBounds=!0;this.update(this.chart)};noname.XYPlot.prototype.autoCalcBounds=function(){this.updateBounds=!0;this.update(this.chart)};noname.BarRenderer=function(){if(!(this instanceof noname.BarRenderer))return new noname.BarRenderer;this.colors=d3.scale.category10().range(noname.Colors.blueOcean());this.toolTipHandler=null;this.listeners=[]};noname.BarRenderer.prototype.bounds=function(a){return a.bounds()};noname.BarRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","bar");this.update(a,b,c,d,e)};
noname.BarRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".bar");var g=this.colors;e=a.selectAll(".series").data(b.dataset.data.rows);a=b.dataset.rowCount();var f=c.rangeBand()/a;e.enter().append("g").attr("class","series").attr("noname:seriesKey",function(a){return a[0]});e=e.selectAll("rect").data(function(a){return a[1]});e.enter().append("rect").attr("transform",function(a,d){var e=b.dataset.rowIndex(this.parentElement.__data__[0]);return"translate("+(d*c.rangeBand()+e*f)+",0)"}).style("fill",
function(a){return g(this.parentElement.__data__[0])});e.attr("y",function(a){return Math.min(d(0),d(a))}).attr("height",function(a){return Math.abs(d(0)-d(a))}).attr("width",c.rangeBand()/a);e.exit().remove()};noname.LineRenderer=function(){if(!(this instanceof noname.LineRenderer))return new noname.LineRenderer;this.colors=d3.scale.category10();this.toolTipHandler=null;this.listeners=[]};noname.LineRenderer.prototype.bounds=function(a){return a.bounds()};noname.LineRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","line");this.update(a,b,c,d,e)};
noname.LineRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".line");var g=this.colors;a=a.selectAll(".series").data(b.dataset.data.rows);var f=d3.svg.line().x(function(a,d){var e=c(b.dataset.data.columnKeys[d]),f=c.rangeBand();return e+f/2}).y(function(a){return d(a)}).interpolate("linear");a.enter().append("g").attr("class","series").attr("noname:seriesKey",function(a){return a[0]}).append("path").attr("d",function(a){return f(a[1])}).style("stroke",function(a){return g(a[0])}).style("fill",
"none");a.select("path").attr("d",function(a){return f(a[1])})};noname.ScatterRenderer=function(){if(!(this instanceof noname.ScatterRenderer))return new noname.ScatterRenderer;this.colors=d3.scale.category10();this.radius=3;this.toolTipHandler=null;this.listeners=[]};
noname.ScatterRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".scatter");var g=this.colors;b=a.selectAll(".series").data(b.dataset.data.series);var f=this.toolTipHandler;b.enter().append("g").attr("class","series").attr("noname:seriesKey",function(a){return a.seriesKey}).on("mouseover",function(a){f&&f.mouseover(d3.event.target,a.seriesKey,d3.event.target.__data__)}).on("mouseout",function(a){f&&f.mouseout(d3.event.target)});b.attr("noname:seriesKey",function(a){return a.seriesKey});b.exit().remove();
b=b.selectAll("circle").data(function(a){return a.items});b.enter().append("circle").attr("r",0).attr("cx",function(a){return c(a.x)}).attr("cy",function(a){return d(a.y)}).style("fill",function(a){return g(this.parentElement.__data__.seriesKey)});b.transition().duration(300).attr("cx",function(a){return c(a.x)}).attr("cy",function(a){return d(a.y)}).attr("r",this.radius);b.exit().remove()};
noname.ScatterRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","scatter");this.update(a,b,c,d,e)};noname.StackedAreaRenderer=function(){if(!(this instanceof noname.StackedAreaRenderer))return new noname.StackedAreaRenderer;this.colors=d3.scale.category10().range(noname.Colors.fancyLight());this.toolTipHandler=null;this.listeners=[];this.offset="zero"};noname.StackedAreaRenderer.prototype.bounds=function(a){a=a.bounds();return[a[0]-6,a[1]+6]};
noname.StackedAreaRenderer.prototype.layers=function(a){var b=[],c=a.rowKeys(),d=[];c.forEach(function(a){d[a]={rowKey:a,values:[]};b.push(d[a])});a.columnKeys().forEach(function(b){c.forEach(function(c){d[c].values.push({colKey:b,value:a.valueByKey(c,b)})})});return b};noname.StackedAreaRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","stackedarea");this.update(a,b,c,d,e)};
noname.StackedAreaRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".stackedarea");var g=this.colors;b=this.layers(b.dataset);e=d3.layout.stack().offset(this.offset).values(function(a){return a.values}).x(function(a){return c(a.colKey)+c.rangeBand()/2}).y(function(a){return a.value});a=a.selectAll(".series").data(e(b)).enter().append("g").attr("class","series");d.domain([0,d3.max(b,function(a){return d3.max(a.values,function(a){return a.y0+a.y})})]);var f=d3.svg.area().interpolate("cardinal").x(function(a){return c(a.colKey)+
c.rangeBand()/2}).y0(function(a){return d(a.y0)}).y1(function(a){return d(a.y0+a.y)});a.append("path").attr("class","streamPath").attr("d",function(a){return f(a.values)}).style("fill",function(a){return g(a.rowKey)})};noname.StackedBarRenderer=function(){if(!(this instanceof noname.StackedBarRenderer))return new noname.StackedBarRenderer;this.colors=d3.scale.category10().range(noname.Colors.iceCube());this.toolTipHandler=null;this.listeners=[]};
noname.StackedBarRenderer.prototype.bounds=function(a){var b=noname.DatasetUtils.extractStackBaseValues(a),c=a.rowKeys(),d=a.columnKeys(),e,g;c.forEach(function(c){d.forEach(function(d){var k=b.valueByKey(c,d);d=a.valueByKey(c,d);e=e?Math.min(e,k+d):k+d;g=g?Math.max(g,k+d):k+d})});return[e,g]};noname.StackedBarRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","stackedbar");this.update(a,b,c,d,e)};
noname.StackedBarRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".stackedbar");var g=this.colors,f=noname.DatasetUtils.extractStackBaseValues(b.dataset);a=a.selectAll(".series").data(b.dataset.data.rows);c.rangeBand();a.enter().append("g").attr("class","series").attr("noname:seriesKey",function(a){return a[0]});a=a.selectAll("rect").data(function(a){return a[1]});a.enter().append("rect").attr("transform",function(a,b){return"translate("+b*c.rangeBand()+",0)"}).style("fill",function(a){return g(this.parentElement.__data__[0])});
a.attr("y",function(a,c){var e=b.dataset.rowIndex(this.parentElement.__data__[0]),e=f.valueByIndex(e,c);return Math.min(d(e),d(e+a))}).attr("height",function(a){return Math.abs(d(0)-d(a))}).attr("width",c.rangeBand());a.exit().remove()};noname.XYLineRenderer=function(){if(!(this instanceof noname.XYLineRenderer))return new noname.XYLineRenderer;this.colors=d3.scale.category10();this.toolTipHandler=null;this.listeners=[]};noname.XYLineRenderer.prototype.build=function(a,b,c,d,e){e.append("g").attr("class","line");this.update(a,b,c,d,e)};
noname.XYLineRenderer.prototype.update=function(a,b,c,d,e){a=e.select(".line");var g=this.colors;b=a.selectAll(".series").data(b.dataset.data.series);var f=d3.svg.line().x(function(a){return c(a[0])}).y(function(a){return d(a[1])}).interpolate("linear");b.enter().append("g").attr("class","series").attr("noname:seriesKey",function(a){return a[0]}).append("path").attr("d",function(a){return f(a[1])}).style("stroke",function(a){return g(a[0])}).style("fill","none");b.select("path").attr("d",function(a){return f(a[1])})};noname.Chart=function(a){if(!(this instanceof noname.Chart))return new noname.Chart;this.margin={top:15,right:30,bottom:30,left:40};this.width=400;this.height=240;this.plot=a;this.plot.addListener(this);this.plot.chart=this;this.listeners=[]};noname.Chart.prototype.plotChanged=function(a){};noname.Chart.prototype.setPlot=function(a){};
noname.Chart.prototype.build=function(a){this.elementId=a;a=d3.select(a).append("svg").attr("width",this.width).attr("height",this.height).append("g");a.append("rect").attr("x",0.5).attr("y",0.5).attr("width",this.width-1).attr("height",this.height-1).attr("style","fill:rgb(255,255,255);stroke-width:1;stroke:rgb(100,100,100)");this.plot.build(this,a)};noname.Colors={};noname.Colors.fancyLight=function(){return"#64E1D5 #E2D75E #F0A4B5 #E7B16D #C2D58D #CCBDE4 #6DE4A8 #93D2E2 #AEE377 #A0D6B5".split(" ")};noname.Colors.fancyDark=function(){return"#3A6163 #8A553A #4A6636 #814C57 #675A6F #384027 #373B43 #59372C #306950 #665D31".split(" ")};noname.Colors.iceCube=function(){return"#4CE4B7 #45756F #C2D9BF #58ADAF #4EE9E1 #839C89 #3E8F74 #92E5C1 #99E5E0 #57BDAB".split(" ")};noname.Colors.blueOcean=function(){return"#6E7094 #4F76DF #292E39 #2E4476 #696A72 #4367A6 #5E62B7 #42759A #2E3A59 #4278CA".split(" ")};
